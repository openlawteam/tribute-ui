(this["webpackJsonptribute-ui"]=this["webpackJsonptribute-ui"]||[]).push([[6],{1003:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return _}));var s=a(7),r=a(145),n=a(36),o=a(51),c=a(17),i=a(31),d=a(4),l=a.n(d),p=a(3),b=a(11),u=a(5),j=a(1),O=a(18),h=a(59),m=a(34),f=a(69),x=a(19),g=a(62),I=a(6),N=a(89),y=a(66),w=a(23),D=a(52),P=a(0),A={skipIsActiveMemberCheck:!0};function v(e){var t=e.disabled,a=e.proposal.snapshotProposal,s=Object(j.useState)(),r=Object(u.a)(s,2),n=r[0],o=r[1],c=Object(O.c)((function(e){return e.contracts})),d=Object(O.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),v=Object(x.f)().account,F=Object(x.a)(),S=F.txEtherscanURL,L=F.txIsPromptOpen,E=F.txSend,_=F.txStatus,G=Object(g.e)(A),R=G.isDisabled,k=G.openWhyDisabledModal,C=G.WhyDisabledModal,M=Object(x.b)(),W=_===I.e.AWAITING_CONFIRM||_===I.e.PENDING,T=_===I.e.FULFILLED,V=W||T||L,U=R||V||t;function J(){return(J=Object(b.a)(l.a.mark((function e(){var t,s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:return t=Object(m.e)(a.actionId,c),s=[d,a.idInDAO],r=Object(p.a)({from:v||""},M?{gasPrice:M.fast}:null),e.next=10,E("processProposal",t.instance.methods,s,r);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),o(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:U,onClick:U?function(){}:function(){return J.apply(this,arguments)},children:W?Object(P.jsx)(D.a,{}):T?"Done":"Process"}),Object(P.jsx)(i.a,{error:n,renderText:"Something went wrong"}),V&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){switch(_){case I.e.AWAITING_CONFIRM:return Object(P.jsxs)(P.Fragment,{children:["Awaiting your confirmation",Object(P.jsx)(h.a,{})]});case I.e.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:f.b,useFirstItemStart:!0,render:function(e){return Object(P.jsx)(w.a,{children:e},e)}}),Object(P.jsx)(y.a,{url:S,isPending:!0})]});case I.e.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:S})]});default:return null}}()}),R&&Object(P.jsx)("button",{className:"button--help-centered",onClick:k,children:"Why is processing disabled?"})]}),Object(P.jsx)(C,{title:"Why is processing disabled?"})]})}var F=a(20);function S(e){var t=e.proposal,a=t.snapshotDraft,s=t.refetchProposalOrDraft,r=Object(j.useState)(),n=Object(u.a)(r,2),c=n[0],d=n[1],h=Object(O.c)((function(e){return e.contracts})),A=Object(O.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),v=Object(x.f)(),S=v.account,L=v.web3Instance,E=Object(x.a)(),_=E.txEtherscanURL,G=E.txIsPromptOpen,R=E.txSend,k=E.txStatus,C=Object(g.e)(),M=C.isDisabled,W=C.openWhyDisabledModal,T=C.WhyDisabledModal,V=Object(o.g)(),U=V.proposalSignAndSendStatus,J=V.signAndSendProposal,q=Object(x.b)(),z=k===I.e.AWAITING_CONFIRM||k===I.e.PENDING||U===I.e.AWAITING_CONFIRM||U===I.e.PENDING,B=k===I.e.FULFILLED&&U===I.e.FULFILLED,H=z||B||G;function K(){return(K=Object(b.a)(l.a.mark((function e(){var t,r,n,o,c,i,b,u,j,O,f,x,g;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(m.e)(a.actionId,h),r=a.msg,n=r.payload,o=n.name,c=n.body,i=n.metadata,b=r.timestamp,e.next=9,J({partialProposalData:{name:o,body:c,metadata:i,timestamp:b},adapterAddress:t.contractAddress,type:F.SnapshotType.proposal});case 9:return u=e.sent,j=u.data,O=u.signature,f=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},L),x=[A,a.idInDAO,f],g=Object(p.a)({from:S||""},q?{gasPrice:q.fast}:null),e.next=17,R("sponsorProposal",t.instance.methods,x,g);case 17:s(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),d(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:M||H,onClick:M||H?function(){}:function(){return K.apply(this,arguments)},children:z?Object(P.jsx)(D.a,{}):B?"Done":"Sponsor"}),Object(P.jsx)(i.a,{error:c,renderText:"Something went wrong"}),H&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){if(k===I.e.AWAITING_CONFIRM||U===I.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(k){case I.e.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:f.b,useFirstItemStart:!0,render:function(e){return Object(P.jsx)(w.a,{children:e},e)}}),Object(P.jsx)(y.a,{url:_,isPending:!0})]});case I.e.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:_})]});default:return null}}()}),M&&Object(P.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is sponsoring disabled?"})]}),Object(P.jsx)(T,{title:"Why is sponsoring disabled?"})]})}var L=a(35);function E(e){var t=e.proposal,a=t.snapshotDraft,s=t.refetchProposalOrDraft,r=Object(j.useState)(),n=Object(u.a)(r,2),c=n[0],d=n[1],h=Object(O.c)((function(e){return e.contracts})),A=Object(O.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),v=Object(x.f)(),S=v.account,E=v.web3Instance,_=Object(x.a)(),G=_.txEtherscanURL,R=_.txIsPromptOpen,k=_.txSend,C=_.txStatus,M=Object(g.e)(),W=M.isDisabled,T=M.openWhyDisabledModal,V=M.WhyDisabledModal,U=Object(o.g)(),J=U.proposalSignAndSendStatus,q=U.signAndSendProposal,z=Object(x.b)(),B=C===I.e.AWAITING_CONFIRM||C===I.e.PENDING||J===I.e.AWAITING_CONFIRM||J===I.e.PENDING,H=C===I.e.FULFILLED&&J===I.e.FULFILLED,K=B||H||R;function Q(){return(Q=Object(b.a)(l.a.mark((function e(){var t,r,n,o,c,i,b,u,j,O,f,x,g;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(m.e)(a.actionId,h),r=a.msg,n=r.payload,o=n.name,c=n.body,i=n.metadata,b=r.timestamp,e.next=9,q({partialProposalData:{name:o,body:c,metadata:i,timestamp:b},adapterAddress:t.contractAddress,type:F.SnapshotType.proposal});case 9:return u=e.sent,j=u.data,O=u.signature,f=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),x=[A,a.idInDAO].concat(Object(L.a)(i.submitActionArgs||[]),[f]),g=Object(p.a)({from:S||""},z?{gasPrice:z.fast}:null),e.next=17,k("submitProposal",t.instance.methods,x,g);case 17:s(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),d(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:W||K,onClick:W||K?function(){}:function(){return Q.apply(this,arguments)},children:B?Object(P.jsx)(D.a,{}):H?"Done":"Sponsor"}),Object(P.jsx)(i.a,{error:c,renderText:"Something went wrong"}),K&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){if(C===I.e.AWAITING_CONFIRM||J===I.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(C){case I.e.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:f.b,useFirstItemStart:!0,render:function(e){return Object(P.jsx)(w.a,{children:e},e)}}),Object(P.jsx)(y.a,{url:G,isPending:!0})]});case I.e.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:G})]});default:return null}}()}),W&&Object(P.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is sponsoring disabled?"})]}),Object(P.jsx)(V,{title:"Why is sponsoring disabled?"})]})}function _(e){var t=e.adapterName,a=e.proposal,d=e.renderAction,l=Object(o.c)(a),p=l.daoProposalVoteResult,b=l.daoProposalVotes,u=l.proposalFlowStatusError,j=l.status,O=b&&j===n.c.OffchainVotingGracePeriod?1e3*Number(b.gracePeriodStartingTime)||Date.now():0,h=d&&d(Object(s.a)({},c.c.OffchainVotingContract,{adapterName:t,daoProposalVoteResult:p,daoProposalVotes:b,gracePeriodStartMs:O,proposal:a,status:j}));return Object(P.jsxs)(P.Fragment,{children:[(j===n.c.OffchainVoting||j===n.c.OffchainVotingSubmitResult||j===n.c.OffchainVotingGracePeriod||j===n.c.Process||j===n.c.Completed)&&Object(P.jsx)(r.c,{countdownGracePeriodStartMs:O,proposal:a}),Object(P.jsx)("div",{className:"proposaldetails__button-container",children:h||(j===n.c.Submit?Object(P.jsx)(E,{proposal:a}):j===n.c.Sponsor?Object(P.jsx)(S,{proposal:a}):j===n.c.OffchainVoting?Object(P.jsx)(r.b,{adapterName:t,proposal:a}):j===n.c.OffchainVotingSubmitResult?Object(P.jsx)(r.a,{adapterName:t,proposal:a}):j===n.c.Process||j===n.c.OffchainVotingGracePeriod?Object(P.jsx)(v,{disabled:j===n.c.OffchainVotingGracePeriod,proposal:a}):void 0)}),Object(P.jsx)(i.a,{error:u,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=6.d9d813bd.chunk.js.map