(this["webpackJsonpmolochv3-ui"]=this["webpackJsonpmolochv3-ui"]||[]).push([[6],{1003:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return _}));var s=a(0),r=a(7),n=a(145),o=a(36),c=a(51),i=a(17),d=a(31),l=a(4),p=a.n(l),b=a(3),u=a(11),j=a(5),O=a(1),h=a(18),m=a(59),f=a(34),x=a(69),g=a(19),I=a(62),N=a(6),y=a(89),w=a(66),D=a(23),P=a(52),v={skipIsActiveMemberCheck:!0};function A(e){var t=e.disabled,a=e.proposal.snapshotProposal,r=Object(O.useState)(),n=Object(j.a)(r,2),o=n[0],c=n[1],i=Object(h.c)((function(e){return e.contracts})),l=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),A=Object(g.f)().account,F=Object(g.a)(),S=F.txEtherscanURL,L=F.txIsPromptOpen,E=F.txSend,_=F.txStatus,G=Object(I.e)(v),R=G.isDisabled,k=G.openWhyDisabledModal,C=G.WhyDisabledModal,M=Object(g.b)(),W=_===N.e.AWAITING_CONFIRM||_===N.e.PENDING,T=_===N.e.FULFILLED,V=W||T||L,U=R||V||t;function J(){return(J=Object(u.a)(p.a.mark((function e(){var t,s,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:return t=Object(f.e)(a.actionId,i),s=[l,a.idInDAO],r=Object(b.a)({from:A||""},M?{gasPrice:M.fast}:null),e.next=10,E("processProposal",t.instance.methods,s,r);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),c(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("button",{className:"proposaldetails__button",disabled:U,onClick:U?function(){}:function(){return J.apply(this,arguments)},children:W?Object(s.jsx)(P.a,{}):T?"Done":"Process"}),Object(s.jsx)(d.a,{error:o,renderText:"Something went wrong"}),V&&Object(s.jsx)("div",{className:"form__submit-status-container",children:function(){switch(_){case N.e.AWAITING_CONFIRM:return Object(s.jsxs)(s.Fragment,{children:["Awaiting your confirmation",Object(s.jsx)(m.a,{})]});case N.e.PENDING:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(e){return Object(s.jsx)(D.a,{children:e},e)}}),Object(s.jsx)(w.a,{url:S,isPending:!0})]});case N.e.FULFILLED:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:"Proposal submitted!"}),Object(s.jsx)(w.a,{url:S})]});default:return null}}()}),R&&Object(s.jsx)("button",{className:"button--help-centered",onClick:k,children:"Why is processing disabled?"})]}),Object(s.jsx)(C,{title:"Why is processing disabled?"})]})}var F=a(20);function S(e){var t=e.proposal,a=t.snapshotDraft,r=t.refetchProposalOrDraft,n=Object(O.useState)(),o=Object(j.a)(n,2),i=o[0],l=o[1],m=Object(h.c)((function(e){return e.contracts})),v=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),A=Object(g.f)(),S=A.account,L=A.web3Instance,E=Object(g.a)(),_=E.txEtherscanURL,G=E.txIsPromptOpen,R=E.txSend,k=E.txStatus,C=Object(I.e)(),M=C.isDisabled,W=C.openWhyDisabledModal,T=C.WhyDisabledModal,V=Object(c.g)(),U=V.proposalSignAndSendStatus,J=V.signAndSendProposal,q=Object(g.b)(),z=k===N.e.AWAITING_CONFIRM||k===N.e.PENDING||U===N.e.AWAITING_CONFIRM||U===N.e.PENDING,B=k===N.e.FULFILLED&&U===N.e.FULFILLED,H=z||B||G;function K(){return(K=Object(u.a)(p.a.mark((function e(){var t,s,n,o,c,i,d,u,j,O,h,x,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,v){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(f.e)(a.actionId,m),s=a.msg,n=s.payload,o=n.name,c=n.body,i=n.metadata,d=s.timestamp,e.next=9,J({partialProposalData:{name:o,body:c,metadata:i,timestamp:d},adapterAddress:t.contractAddress,type:F.SnapshotType.proposal});case 9:return u=e.sent,j=u.data,O=u.signature,h=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},L),x=[v,a.idInDAO,h],g=Object(b.a)({from:S||""},q?{gasPrice:q.fast}:null),e.next=17,R("sponsorProposal",t.instance.methods,x,g);case 17:r(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),l(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("button",{className:"proposaldetails__button",disabled:M||H,onClick:M||H?function(){}:function(){return K.apply(this,arguments)},children:z?Object(s.jsx)(P.a,{}):B?"Done":"Sponsor"}),Object(s.jsx)(d.a,{error:i,renderText:"Something went wrong"}),H&&Object(s.jsx)("div",{className:"form__submit-status-container",children:function(){if(k===N.e.AWAITING_CONFIRM||U===N.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(k){case N.e.PENDING:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(e){return Object(s.jsx)(D.a,{children:e},e)}}),Object(s.jsx)(w.a,{url:_,isPending:!0})]});case N.e.FULFILLED:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:"Proposal submitted!"}),Object(s.jsx)(w.a,{url:_})]});default:return null}}()}),M&&Object(s.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is sponsoring disabled?"})]}),Object(s.jsx)(T,{title:"Why is sponsoring disabled?"})]})}var L=a(35);function E(e){var t=e.proposal,a=t.snapshotDraft,r=t.refetchProposalOrDraft,n=Object(O.useState)(),o=Object(j.a)(n,2),i=o[0],l=o[1],m=Object(h.c)((function(e){return e.contracts})),v=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),A=Object(g.f)(),S=A.account,E=A.web3Instance,_=Object(g.a)(),G=_.txEtherscanURL,R=_.txIsPromptOpen,k=_.txSend,C=_.txStatus,M=Object(I.e)(),W=M.isDisabled,T=M.openWhyDisabledModal,V=M.WhyDisabledModal,U=Object(c.g)(),J=U.proposalSignAndSendStatus,q=U.signAndSendProposal,z=Object(g.b)(),B=C===N.e.AWAITING_CONFIRM||C===N.e.PENDING||J===N.e.AWAITING_CONFIRM||J===N.e.PENDING,H=C===N.e.FULFILLED&&J===N.e.FULFILLED,K=B||H||R;function Q(){return(Q=Object(u.a)(p.a.mark((function e(){var t,s,n,o,c,i,d,u,j,O,h,x,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,v){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(f.e)(a.actionId,m),s=a.msg,n=s.payload,o=n.name,c=n.body,i=n.metadata,d=s.timestamp,e.next=9,q({partialProposalData:{name:o,body:c,metadata:i,timestamp:d},adapterAddress:t.contractAddress,type:F.SnapshotType.proposal});case 9:return u=e.sent,j=u.data,O=u.signature,h=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),x=[v,a.idInDAO].concat(Object(L.a)(i.submitActionArgs||[]),[h]),g=Object(b.a)({from:S||""},z?{gasPrice:z.fast}:null),e.next=17,k("submitProposal",t.instance.methods,x,g);case 17:r(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),l(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("button",{className:"proposaldetails__button",disabled:W||K,onClick:W||K?function(){}:function(){return Q.apply(this,arguments)},children:B?Object(s.jsx)(P.a,{}):H?"Done":"Sponsor"}),Object(s.jsx)(d.a,{error:i,renderText:"Something went wrong"}),K&&Object(s.jsx)("div",{className:"form__submit-status-container",children:function(){if(C===N.e.AWAITING_CONFIRM||J===N.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(C){case N.e.PENDING:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(e){return Object(s.jsx)(D.a,{children:e},e)}}),Object(s.jsx)(w.a,{url:G,isPending:!0})]});case N.e.FULFILLED:return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:"Proposal submitted!"}),Object(s.jsx)(w.a,{url:G})]});default:return null}}()}),W&&Object(s.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is sponsoring disabled?"})]}),Object(s.jsx)(V,{title:"Why is sponsoring disabled?"})]})}function _(e){var t=e.adapterName,a=e.proposal,l=e.renderAction,p=Object(c.c)(a),b=p.daoProposalVoteResult,u=p.daoProposalVotes,j=p.proposalFlowStatusError,O=p.status,h=u&&O===o.c.OffchainVotingGracePeriod?1e3*Number(u.gracePeriodStartingTime)||Date.now():0,m=l&&l(Object(r.a)({},i.c.OffchainVotingContract,{adapterName:t,daoProposalVoteResult:b,daoProposalVotes:u,gracePeriodStartMs:h,proposal:a,status:O}));return Object(s.jsxs)(s.Fragment,{children:[(O===o.c.OffchainVoting||O===o.c.OffchainVotingSubmitResult||O===o.c.OffchainVotingGracePeriod||O===o.c.Process||O===o.c.Completed)&&Object(s.jsx)(n.c,{countdownGracePeriodStartMs:h,proposal:a}),Object(s.jsx)("div",{className:"proposaldetails__button-container",children:m||(O===o.c.Submit?Object(s.jsx)(E,{proposal:a}):O===o.c.Sponsor?Object(s.jsx)(S,{proposal:a}):O===o.c.OffchainVoting?Object(s.jsx)(n.b,{adapterName:t,proposal:a}):O===o.c.OffchainVotingSubmitResult?Object(s.jsx)(n.a,{adapterName:t,proposal:a}):O===o.c.Process||O===o.c.OffchainVotingGracePeriod?Object(s.jsx)(A,{disabled:O===o.c.OffchainVotingGracePeriod,proposal:a}):void 0)}),Object(s.jsx)(d.a,{error:j,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=6.2be2ac06.chunk.js.map