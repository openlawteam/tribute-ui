(this["webpackJsonpmolochv3-ui"]=this["webpackJsonpmolochv3-ui"]||[]).push([[6],{1003:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return G}));var a=r(0),n=r(144),s=r(77),c=r(10),o=r(61),i=r(49),u=r(4),d=r.n(u),l=r(3),b=r(34),p=r(13),j=r(5),O=r(1),h=r(18),f=r(19),x=r(33),m=r(94),g=r(20),v=r(66),I=r(146),N=r(35),w=r(110),y=r(23),P=r(60);function A(e){var t=e.proposal,r=t.snapshotDraft,n=t.refetchProposalOrDraft,s=Object(O.useState)(),o=Object(j.a)(s,2),u=o[0],A=o[1],D=Object(h.c)((function(e){return e.contracts})),F=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),k=Object(g.f)(),S=k.account,E=k.web3Instance,C=Object(g.a)(),L=C.txEtherscanURL,R=C.txIsPromptOpen,M=C.txSend,_=C.txStatus,G=Object(v.e)(),W=G.isDisabled,T=G.openWhyDisabledModal,U=G.WhyDisabledModal,V=Object(i.g)(),z=V.proposalSignAndSendStatus,B=V.signAndSendProposal,J=Object(g.b)(),Y=_===c.e.AWAITING_CONFIRM||_===c.e.PENDING||z===c.e.AWAITING_CONFIRM||z===c.e.PENDING,q=_===c.e.FULFILLED&&z===c.e.FULFILLED,H=Y||q||R;function K(){return(K=Object(p.a)(d.a.mark((function e(){var t,a,s,c,o,i,u,p,j,O,h,m,g;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(r){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(x.e)(r.actionId,D),a=r.msg,s=a.payload,c=s.name,o=s.body,i=s.metadata,u=a.timestamp,e.next=9,B({partialProposalData:{name:c,body:o,metadata:i,timestamp:u},adapterAddress:t.contractAddress,type:f.SnapshotType.proposal});case 9:return p=e.sent,j=p.data,O=p.signature,h=Object(f.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),m=[F,r.idInDAO].concat(Object(b.a)(i.submitActionArgs||[]),[h]),g=Object(l.a)({from:S||""},J?{gasPrice:J.fast}:null),e.next=17,M("submitProposal",t.instance.methods,m,g);case 17:n(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),A(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:W||H,onClick:W||H?function(){}:function(){return K.apply(this,arguments)},children:Y?Object(a.jsx)(P.a,{}):q?"Done":"Sponsor"}),Object(a.jsx)(N.a,{error:u,renderText:"Something went wrong"}),H&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){if(_===c.e.AWAITING_CONFIRM||z===c.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(_){case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:L,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Proposal submitted!"}),Object(a.jsx)(w.a,{url:L})]});default:return null}}()}),W&&Object(a.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is sponsoring disabled?"})]}),Object(a.jsx)(U,{title:"Why is sponsoring disabled?"})]})}function D(e){var t=e.proposal,r=t.snapshotDraft,n=t.refetchProposalOrDraft,s=Object(O.useState)(),o=Object(j.a)(s,2),u=o[0],b=o[1],A=Object(h.c)((function(e){return e.contracts})),D=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),F=Object(g.f)(),k=F.account,S=F.web3Instance,E=Object(g.a)(),C=E.txEtherscanURL,L=E.txIsPromptOpen,R=E.txSend,M=E.txStatus,_=Object(v.e)(),G=_.isDisabled,W=_.openWhyDisabledModal,T=_.WhyDisabledModal,U=Object(i.g)(),V=U.proposalSignAndSendStatus,z=U.signAndSendProposal,B=Object(g.b)(),J=M===c.e.AWAITING_CONFIRM||M===c.e.PENDING||V===c.e.AWAITING_CONFIRM||V===c.e.PENDING,Y=M===c.e.FULFILLED&&V===c.e.FULFILLED,q=J||Y||L;function H(){return(H=Object(p.a)(d.a.mark((function e(){var t,a,s,c,o,i,u,p,j,O,h,m,g;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,D){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(r){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(x.e)(r.actionId,A),a=r.msg,s=a.payload,c=s.name,o=s.body,i=s.metadata,u=a.timestamp,e.next=9,z({partialProposalData:{name:c,body:o,metadata:i,timestamp:u},adapterAddress:t.contractAddress,type:f.SnapshotType.proposal});case 9:return p=e.sent,j=p.data,O=p.signature,h=Object(f.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},S),m=[D,r.idInDAO,h],g=Object(l.a)({from:k||""},B?{gasPrice:B.fast}:null),e.next=17,R("sponsorProposal",t.instance.methods,m,g);case 17:n(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),b(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:G||q,onClick:G||q?function(){}:function(){return H.apply(this,arguments)},children:J?Object(a.jsx)(P.a,{}):Y?"Done":"Sponsor"}),Object(a.jsx)(N.a,{error:u,renderText:"Something went wrong"}),q&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){if(M===c.e.AWAITING_CONFIRM||V===c.e.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(M){case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:C,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Proposal submitted!"}),Object(a.jsx)(w.a,{url:C})]});default:return null}}()}),G&&Object(a.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is sponsoring disabled?"})]}),Object(a.jsx)(T,{title:"Why is sponsoring disabled?"})]})}var F=r(70),k={skipIsActiveMemberCheck:!0};function S(e){var t=e.disabled,r=e.proposal.snapshotProposal,n=Object(O.useState)(),s=Object(j.a)(n,2),o=s[0],i=s[1],u=Object(h.c)((function(e){return e.contracts})),b=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),f=Object(g.f)().account,A=Object(g.a)(),D=A.txEtherscanURL,S=A.txIsPromptOpen,E=A.txSend,C=A.txStatus,L=Object(v.e)(k),R=L.isDisabled,M=L.openWhyDisabledModal,_=L.WhyDisabledModal,G=Object(g.b)(),W=C===c.e.AWAITING_CONFIRM||C===c.e.PENDING,T=C===c.e.FULFILLED,U=W||T||S,V=R||U||t;function z(){return(z=Object(p.a)(d.a.mark((function e(){var t,a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(r){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:return t=Object(x.e)(r.actionId,u),a=[b,r.idInDAO],n=Object(l.a)({from:f||""},G?{gasPrice:G.fast}:null),e.next=10,E("processProposal",t.instance.methods,a,n);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),i(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:V,onClick:V?function(){}:function(){return z.apply(this,arguments)},children:W?Object(a.jsx)(P.a,{}):T?"Done":"Process"}),Object(a.jsx)(N.a,{error:o,renderText:"Something went wrong"}),U&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){switch(C){case c.e.AWAITING_CONFIRM:return Object(a.jsxs)(a.Fragment,{children:["Awaiting your confirmation",Object(a.jsx)(F.a,{})]});case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:D,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Proposal submitted!"}),Object(a.jsx)(w.a,{url:D})]});default:return null}}()}),R&&Object(a.jsx)("button",{className:"button--help-centered",onClick:M,children:"Why is processing disabled?"})]}),Object(a.jsx)(_,{title:"Why is processing disabled?"})]})}var E={skipIsActiveMemberCheck:!0};function C(e){var t=e.disabled,r=e.proposal.snapshotProposal,n=e.isProposalPassed,s=Object(O.useState)(),o=Object(j.a)(s,2),i=o[0],u=o[1],b=Object(O.useState)(),f=Object(j.a)(b,2),x=f[0],A=f[1],D=Object(O.useRef)({notProposerMessage:""}),k=Object(h.c)((function(e){var t;return null===(t=e.contracts)||void 0===t?void 0:t.OnboardingContract})),S=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),C=Object(g.f)().account,L=Object(g.a)(),R=L.txEtherscanURL,M=L.txIsPromptOpen,_=L.txSend,G=L.txStatus,W=Object(v.e)(E),T=W.isDisabled,U=W.openWhyDisabledModal,V=W.WhyDisabledModal,z=W.setOtherDisabledReasons,B=Object(g.b)(),J=G===c.e.AWAITING_CONFIRM||G===c.e.PENDING,Y=G===c.e.FULFILLED,q=J||Y||M,H=T||q||t,K=Object(O.useCallback)((function(){return Q.apply(this,arguments)}),[k,S,r]);function Q(){return(Q=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r&&k){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,k.instance.methods.proposals(S,r.idInDAO).call();case 5:t=e.sent,A(t.amount),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),A(void 0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function X(){return(X=Object(p.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,S){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(r){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(k){e.next=7;break}throw new Error("No OnboardingContract found.");case 7:return t=[S,r.idInDAO],a=Object(l.a)({from:C||"",value:x},B?{gasPrice:B.fast}:null),e.next=11,_("processProposal",k.instance.methods,t,a);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),u(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}return Object(O.useEffect)((function(){n&&K()}),[K,n]),Object(O.useEffect)((function(){if(n){var e=r.msg.payload.metadata.accountAuthorizedToProcessPassedProposal;e&&C&&(D.current=Object(l.a)(Object(l.a)({},D.current),{},{notProposerMessage:e.toLowerCase()!==C.toLowerCase()?"Only the original proposer can process the proposal.":""})),z(Object.values(D.current))}}),[C,n,z,r]),Object(a.jsx)(a.Fragment,{children:n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:H,onClick:H?function(){}:function(){return X.apply(this,arguments)},children:J?Object(a.jsx)(P.a,{}):Y?"Done":"Process"}),Object(a.jsx)(N.a,{error:i,renderText:"Something went wrong"}),q&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){switch(G){case c.e.AWAITING_CONFIRM:return Object(a.jsxs)(a.Fragment,{children:["Confirm to process the proposal",Object(a.jsx)(F.a,{})]});case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:R,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Proposal submitted!"}),Object(a.jsx)(w.a,{url:R})]});default:return null}}()}),T&&Object(a.jsx)("button",{className:"button--help-centered",onClick:U,children:"Why is processing disabled?"})]}),Object(a.jsx)(V,{title:"Why is processing disabled?"})]}):Object(a.jsx)(a.Fragment,{})})}var L=r(25),R={skipIsActiveMemberCheck:!0};function M(e){var t=e.disabled,n=e.proposal.snapshotProposal,s=e.isProposalPassed,o=Object(O.useState)(),i=Object(j.a)(o,2),u=i[0],b=i[1],f=Object(O.useState)(),x=Object(j.a)(f,2),A=x[0],D=x[1],k=Object(O.useRef)({notProposerMessage:""}),S=Object(h.c)((function(e){var t;return null===(t=e.contracts)||void 0===t?void 0:t.TributeContract})),E=Object(h.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),C=Object(g.f)(),M=C.account,_=C.web3Instance,G=Object(g.a)(),W=G.txEtherscanURL,T=G.txIsPromptOpen,U=G.txSend,V=G.txStatus,z=Object(g.a)(),B=z.txEtherscanURL,J=z.txIsPromptOpen,Y=z.txSend,q=z.txStatus,H=Object(v.e)(R),K=H.isDisabled,Q=H.openWhyDisabledModal,X=H.WhyDisabledModal,Z=H.setOtherDisabledReasons,$=Object(g.b)(),ee=V===c.e.AWAITING_CONFIRM||V===c.e.PENDING||q===c.e.AWAITING_CONFIRM||q===c.e.PENDING,te=V===c.e.FULFILLED,re=ee||te||T||J,ae=K||re||t,ne=Object(O.useCallback)((function(){return se.apply(this,arguments)}),[S,E,n]);function se(){return(se=Object(p.a)(d.a.mark((function e(){var t,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n&&S){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,S.instance.methods.proposals(E,n.idInDAO).call();case 5:t=e.sent,r=t.token,a=t.tributeAmount,D({tokenAddress:r,tributeAmount:a}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),D(void 0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function ce(){return oe.apply(this,arguments)}function oe(){return(oe=Object(p.a)(d.a.mark((function e(){var t,a,n,s,c,o,i,u,b,p,j,O,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A){e.next=3;break}throw new Error("No Tribute proposal details found.");case 3:if(S){e.next=5;break}throw new Error("No TributeContract found.");case 5:if(M){e.next=7;break}throw new Error("No account found.");case 7:return t=A.tokenAddress,a=A.tributeAmount,e.next=10,Promise.resolve().then(r.t.bind(null,462,3));case 10:return n=e.sent,s=n.default,c=s,o=new _.eth.Contract(c,t),e.next=16,o.methods.allowance(M,S.contractAddress).call();case 16:if(i=e.sent,u=Object(L.toBN)(a),b=Object(L.toBN)(i),!u.gt(b)){e.next=32;break}return e.prev=20,p=u.sub(b),j=b.add(p),O=[S.contractAddress,j.toString()],h=Object(l.a)({from:M||""},$?{gasPrice:$.fast}:null),e.next=27,Y("approve",o.methods,O,h);case 27:e.next=32;break;case 29:throw e.prev=29,e.t0=e.catch(20),new Error("Your ERC20 tokens could not be approved for transfer.");case 32:e.next=37;break;case 34:throw e.prev=34,e.t1=e.catch(0),e.t1;case 37:case"end":return e.stop()}}),e,null,[[0,34],[20,29]])})))).apply(this,arguments)}function ie(){return(ie=Object(p.a)(d.a.mark((function e(){var t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,E){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(n){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(S){e.next=7;break}throw new Error("No TributeContract found.");case 7:return e.next=9,ce();case 9:return t=[E,n.idInDAO],r=Object(l.a)({from:M||""},$?{gasPrice:$.fast}:null),e.next=13,U("processProposal",S.instance.methods,t,r);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),b(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return Object(O.useEffect)((function(){s&&ne()}),[ne,s]),Object(O.useEffect)((function(){if(s){var e=n.msg.payload.metadata.accountAuthorizedToProcessPassedProposal;e&&M&&(k.current=Object(l.a)(Object(l.a)({},k.current),{},{notProposerMessage:e.toLowerCase()!==M.toLowerCase()?"Only the original proposer can process the proposal.":""})),Z(Object.values(k.current))}}),[M,s,Z,n]),Object(a.jsx)(a.Fragment,{children:s?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:ae,onClick:ae?function(){}:function(){return ie.apply(this,arguments)},children:ee?Object(a.jsx)(P.a,{}):te?"Done":"Process"}),Object(a.jsx)(N.a,{error:u,renderText:"Something went wrong"}),re&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){if(q===c.e.AWAITING_CONFIRM)return Object(a.jsxs)(a.Fragment,{children:["Confirm to transfer your tokens",Object(a.jsx)(F.a,{})]});if(q===c.e.PENDING)return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:["Approving your tokens for transfer",Object(a.jsx)(F.a,{})]}),Object(a.jsx)(w.a,{url:B,isPending:!0})]});switch(V){case c.e.AWAITING_CONFIRM:return Object(a.jsxs)(a.Fragment,{children:["Confirm to process the proposal",Object(a.jsx)(F.a,{})]});case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:W,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Proposal submitted!"}),Object(a.jsx)(w.a,{url:W})]});default:return null}}()}),K&&Object(a.jsx)("button",{className:"button--help-centered",onClick:Q,children:"Why is processing disabled?"})]}),Object(a.jsx)(X,{title:"Why is processing disabled?"})]}):Object(a.jsx)(a.Fragment,{})})}function _(e){var t=e.adapterName,r=e.proposal.snapshotProposal,n=Object(O.useState)(),s=Object(j.a)(n,2),i=s[0],u=s[1],b=Object(O.useRef)({alreadyCompletedMessage:""}),f=Object(h.c)((function(e){return e.contracts})),A=Object(h.c)((function(e){return e.contracts.DaoRegistryContract})),D=Object(g.f)().account,k=Object(g.a)(),S=k.txEtherscanURL,E=k.txIsPromptOpen,C=k.txSend,L=k.txStatus,R=Object(v.e)(),M=R.isDisabled,_=R.openWhyDisabledModal,G=R.WhyDisabledModal,W=R.setOtherDisabledReasons,T=Object(g.b)(),U=L===c.e.AWAITING_CONFIRM||L===c.e.PENDING,V=L===c.e.FULFILLED,z=U||V||E,B=M||z;function J(){return Y.apply(this,arguments)}function Y(){return(Y=Object(p.a)(d.a.mark((function e(){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===c.a.distribute?3:19;break;case 3:if(A){e.next=5;break}throw new Error("No DAO Registry contract was found.");case 5:if(a="0",!(null===r||void 0===r?void 0:r.msg.payload.metadata.isTypeAllMembers)){e.next=18;break}return e.prev=8,e.next=11,A.instance.methods.getNbMembers().call();case 11:n=e.sent,a=n.toString(),e.next=18;break;case 15:throw e.prev=15,e.t1=e.catch(8),new Error("Error while retrieving number of DAO members");case 18:return e.abrupt("return",{functionName:"distribute",functionArguments:[A.contractAddress,a]});case 19:return e.abrupt("return",{functionName:"",functionArguments:[]});case 20:case"end":return e.stop()}}),e,null,[[8,15]])})))).apply(this,arguments)}function q(){return(q=Object(p.a)(d.a.mark((function e(){var t,a,n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}throw new Error("No Snapshot proposal was found.");case 3:return t=Object(x.e)(r.actionId,f),e.next=6,J();case 6:return a=e.sent,n=a.functionName,s=a.functionArguments,c=Object(l.a)({from:D||""},T?{gasPrice:T.fast}:null),e.next=12,C(n,t.instance.methods,s,c);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),u(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function H(){switch(t){case c.a.distribute:return"Assets transferred!";default:return"Action submitted!"}}function K(){switch(t){case c.a.distribute:return{start:"Transfer assets",done:"Transfer done"};default:return{start:"Process action",done:"Done"}}}return Object(O.useEffect)((function(){function e(){return(e=Object(p.a)(d.a.mark((function e(){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==c.a.distribute){e.next=16;break}if(r){e.next=3;break}throw new Error("No Snapshot proposal was found.");case 3:if(A){e.next=5;break}throw new Error("No DAO Registry contract was found.");case 5:return e.prev=5,a=Object(x.e)(r.actionId,f),e.next=9,a.instance.methods.distributions(A.contractAddress,r.idInDAO).call();case 9:n=e.sent,b.current=Object(l.a)(Object(l.a)({},b.current),{},{alreadyCompletedMessage:o.a[n.status]!==o.a[o.a.IN_PROGRESS]?"The transfer has already been completed.":""}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0);case 16:W(Object.values(b.current));case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,f,A,W,r]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"proposaldetails__button",disabled:B,onClick:B?function(){}:function(){return q.apply(this,arguments)},children:U?Object(a.jsx)(P.a,{}):V?K().done:K().start}),Object(a.jsx)(N.a,{error:i,renderText:"Something went wrong"}),z&&Object(a.jsx)("div",{className:"form__submit-status-container",children:function(){switch(L){case c.e.AWAITING_CONFIRM:return Object(a.jsxs)(a.Fragment,{children:["Awaiting your confirmation",Object(a.jsx)(F.a,{})]});case c.e.PENDING:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(a.jsx)(y.a,{children:e},e)}}),Object(a.jsx)(w.a,{url:S,isPending:!0})]});case c.e.FULFILLED:return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:H()}),Object(a.jsx)(w.a,{url:S})]});default:return null}}()}),M&&Object(a.jsx)("button",{className:"button--help-centered",onClick:_,children:"Why is action disabled?"})]}),Object(a.jsx)(G,{title:"Why is action disabled?"})]})}function G(e){var t=e.adapterName,r=e.proposal,u=Object(i.c)(r),d=u.daoProposalVotes,l=u.status,b=u.daoProposalVoteResult,p=d&&l===o.c.OffchainVotingGracePeriod?1e3*Number(d.gracePeriodStartingTime):0,j=t===c.a.distribute&&l===o.c.Completed&&b&&s.a[b]===s.a[s.a.PASS];return Object(a.jsxs)(a.Fragment,{children:[(l===o.c.OffchainVoting||l===o.c.OffchainVotingSubmitResult||l===o.c.OffchainVotingGracePeriod||l===o.c.Process||l===o.c.Completed)&&Object(a.jsx)(n.c,{countdownGracePeriodStartMs:p,proposal:r}),Object(a.jsxs)("div",{className:"proposaldetails__button-container",children:[l===o.c.Submit&&Object(a.jsx)(A,{proposal:r}),l===o.c.Sponsor&&Object(a.jsx)(D,{proposal:r}),l===o.c.OffchainVoting&&Object(a.jsx)(n.b,{adapterName:t,proposal:r}),l===o.c.OffchainVotingSubmitResult&&Object(a.jsx)(n.a,{adapterName:t,proposal:r}),(l===o.c.OffchainVotingGracePeriod||l===o.c.Process)&&function(){switch(t){case c.a.onboarding:return Object(a.jsx)(C,{disabled:l===o.c.OffchainVotingGracePeriod,proposal:r,isProposalPassed:!(!b||s.a[b]!==s.a[s.a.PASS])});case c.a.tribute:return Object(a.jsx)(M,{disabled:l===o.c.OffchainVotingGracePeriod,proposal:r,isProposalPassed:!(!b||s.a[b]!==s.a[s.a.PASS])});default:return Object(a.jsx)(S,{disabled:l===o.c.OffchainVotingGracePeriod,proposal:r})}}(),j&&Object(a.jsx)(_,{adapterName:t,proposal:r})]})]})}}}]);
//# sourceMappingURL=6.11e9b060.chunk.js.map